const classicPreload=!1;var preloaded=[!1,!1,!1];const preloaderImages=["goldenfreddy.jpg","ui/bar.png","ui/map.png","ui/noise.png","power/1.png","power/2.png","power/3.png","power/4.png","door/closed.png","door/open.png","door/light.png","door/00.png","door/01.png","door/10.png","door/11.png","door/20.png","door/21.png","door/30.png","door/31.png","jumpscares/0.gif","jumpscares/1.gif","jumpscares/2.png","jumpscares/3.gif"];var preloaderImageElement=new Image,currentPreloadingImageCount=0;preloaderImages.forEach(e=>{console.log(`%cpreload%c %cimages%c [${currentPreloadingImageCount} / ${preloaderImages.length}]`,"background-color: teal; border-radius: 12px; padding: 0 6px;","","background-color: teal; border-radius: 12px; padding: 0 6px;"),fetch("/assets/"+e),(currentPreloadingImageCount+=1)==preloaderImages.length&&(preloaded[0]=!0)});const preloaderAudios=["ambient/1.ogg","ambient/2.ogg","bgm.mp3","camera-switch.ogg","door-close-l.ogg","door-close-r.ogg","door-open-l.ogg","door-open-r.ogg","end.ogg","knock.ogg","light-l.ogg","light-r.ogg","movement.ogg","jumpscare/2.ogg","jumpscare/3.mp3","stalker.mp3","static.ogg"];var preloaderAudioElement=new Audio,currentPreloadingAudioCount=0;preloaderAudios.forEach(e=>{console.log(`%cpreload%c %caudio%c [${currentPreloadingAudioCount} / ${preloaderAudios.length}]`,"background-color: teal; border-radius: 12px; padding: 0 6px;","","background-color: teal; border-radius: 12px; padding: 0 6px;"),fetch("/assets/audio/"+e),(currentPreloadingAudioCount+=1)==preloaderAudios.length&&(preloaded[1]=!0)});const preloaderRooms=["0-0.webp","0-1.webp","0-2.webp","0-3.webp","0-8.webp","0-9.webp","0-10.webp","0-11.webp","1-0.webp","1-1.webp","1-2.webp","1-3.webp","1-4.webp","1-5.webp","1-6.webp","1-7.webp","2-0.webp","2-1.webp","2-2.webp","2-3.webp","2-4.webp","2-5.webp","2-6.webp","2-7.webp","2-8.webp","2-9.webp","2-10.webp","2-11.webp","2-12.webp","2-13.webp","2-14.webp","2-15.webp","3-0.webp","3-8.webp","4-0.webp","4-1.webp","4-2.webp","4-3.webp","4-8.webp","4-9.webp","4-10.webp","4-11.webp","5-0.webp","5-1.webp","5-2.webp","5-3.webp","5-8.webp","5-9.webp","5-10.webp","5-11.webp","6-0.webp","6-1.webp","6-2.webp","6-3.webp","6-4.webp","6-5.webp","6-6.webp","6-7.webp","6-8.webp","6-9.webp","6-10.webp","6-11.webp","6-12.webp","6-13.webp","6-14.webp","6-15.webp","7-0.webp","7-1.webp","7-2.webp","7-3.webp","7-4.webp","7-5.webp","7-6.webp","7-7.webp","7-8.webp","7-9.webp","7-10.webp","7-11.webp","7-12.webp","7-13.webp","7-14.webp","7-15.webp","8-0.webp","8-4.webp","8-8.webp","8-12.webp","9-0.webp","9-1.webp","9-2.webp","9-3.webp","9-4.webp","9-5.webp","9-6.webp","9-7.webp","9-8.webp","9-9.webp","9-10.webp","9-11.webp","9-12.webp","9-13.webp","9-14.webp","9-15.webp","10-0.webp","10-1.webp","10-2.webp","10-3.webp","10-4.webp","10-5.webp","10-6.webp","10-7.webp","10-8.webp","10-9.webp","10-10.webp","10-11.webp","10-12.webp","10-13.webp","10-14.webp","10-15.webp"];var preloaderRoomsElement=new Image,currentPreloadingRoomsCount=0;preloaderRooms.forEach(e=>{console.log(`%cpreload%c %crooms%c [${currentPreloadingRoomsCount} / ${preloaderRooms.length}]`,"background-color: teal; border-radius: 12px; padding: 0 6px;","","background-color: teal; border-radius: 12px; padding: 0 6px;"),fetch("/assets/rooms/"+e),(currentPreloadingRoomsCount+=1)==preloaderRooms.length&&(preloaded[2]=!0)});var nightData={rooms:{office:{current:[],startpositions:[],denied:[],neighbours:["office"],hasCamera:!1},rhall:{current:[],startpositions:[],denied:[2],neighbours:["rhall","office","pr1"],hasCamera:!0},stage:{current:[],startpositions:[0,1,2],denied:[3],neighbours:["stage","dining"],hasCamera:!0},pr2:{current:[],startpositions:[],denied:[],neighbours:["pr2","dining"],hasCamera:!0},pirate:{current:[],startpositions:[3],denied:[0,1,2],neighbours:["pirate","dining"],hasCamera:!0},pr1:{current:[],startpositions:[],denied:[2],neighbours:["pr1","dining","rhall"],hasCamera:!0},entrance:{current:[],startpositions:[],denied:[2],neighbours:["entrance","dining"],hasCamera:!0},saferoom:{current:[],startpositions:[],denied:[],neighbours:["saferoom","mainhall"],hasCamera:!0},mainhall:{current:[],startpositions:[],denied:[],neighbours:["mainhall","w","m","saferoom","lhall"],hasCamera:!0},lhall:{current:[],startpositions:[],denied:[0,1],neighbours:["lhall","office","mainhall"],hasCamera:!0},dining2:{current:[],startpositions:[],denied:[],neighbours:["dining2","dining","entrance","pr2","pirate"],hasCamera:!0},dining:{current:[],startpositions:[],denied:[],neighbours:["dining","dining2","mainhall","stage","pr1","pr2"],hasCamera:!0},w:{current:[],startpositions:[],denied:[0,1,2],neighbours:["w","mainhall"],hasCamera:!1},m:{current:[],startpositions:[],denied:[3],neighbours:["m","mainhall"],hasCamera:!1}},ai:[]};const mobilecheck=function(){let e=!1;var o;return o=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(o)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(o.substr(0,4)))&&(e=!0),e}();function loader(){3==preloaded.filter(e=>e).length?document.getElementById("loader").remove():setTimeout(()=>{loader()},500)}loader();var doors={l:!1,r:!1},lights={l:!1,r:!1};function getCookie(e){let o=e+"=",t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let s=t[e];for(;" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(o))return s.substring(o.length,s.length)}return""}const currentNight=getCookie("save");switch(currentNight){case"1":case"2":case"3":nightData.ai=[2,2,2,2];break;default:nightData.ai=[20,20,20,20]}var ambientAudioVolume=1,currentAudios=[],availableAudios={},availableAudioId=0;function addAudio(e){return availableAudios[availableAudioId]=new Audio(e),(availableAudioId+=1)-1}function playAudioId(e){console.log(availableAudios[e].src),playAudio(availableAudios[e].src)}const ctx=new AudioContext;let source,gainNode=ctx.createGain();function playAudio(e,o="ambient"){fetch(e).then(e=>e.arrayBuffer()).then(e=>ctx.decodeAudioData(e)).then(e=>{const o=ctx.createBufferSource();o.buffer=e,o.connect(gainNode),o.start(0),o.addEventListener("ended",()=>{const e=currentAudios.indexOf(audio);currentAudios.splice(e,1)})})}function changeVolume(e,o="ambient"){gainNode.gain.level=e}gainNode.connect(ctx.destination),Object.entries(nightData.rooms).forEach(e=>{e[1].startpositions.forEach(o=>{e[1].current.push(o)})});var currentPositionsHistory=[];function checkForAmbient(){let e=[];Object.entries(nightData.rooms).forEach(o=>{o[1].current.forEach(t=>{e[t]=o[0]})}),currentPositionsHistory.length>5&&currentPositionsHistory.shift(),currentPositionsHistory.push(e);var o="[20,20,20,20]"==JSON.stringify(nightData.ai)?3:5,t=currentPositionsHistory;if(t.length>o)for(let e=0;e<t.length-o;e++)t.shift();if(t.length==o){var s=[[],[],[]];t.forEach(e=>{var o=0;e.forEach(e=>{3!=o&&(s[o].push(e),o+=1)})}),s.some(e=>e.every(o=>o===e[0]))&&playAudio("/assets/audio/ambient/2.ogg")}e=e.filter(e=>["m","w"].includes(e)),e.length>=2&&playAudio("/assets/audio/ambient/1.ogg")}var dead=!1,won=!1;function mvTick(){if(dead||won)return;console.log("mv");let e=[],o=[];Object.entries(nightData.rooms).forEach(o=>{o[1].current.forEach(t=>{e[t]=o[0]})}),Object.entries(nightData.rooms).forEach(e=>{e[1].startpositions.forEach(t=>{o[t]=e[0]})});let t=0;nightData.ai.forEach(s=>{if(3===t)if(Math.max(lastCameraOpen,lastCameraClose)+foxyStun>=Date.now()&&!["lhall","rhall"].includes(e[t])||iscameraon)return;if(Math.floor(20*Math.random())<s){const i=nightData.rooms[e[t]];var a=[];Array.from(i.neighbours).forEach(e=>{!Array.from(nightData.rooms[e].denied).includes(t)&&a.push(e)});let l=a[Math.floor(Math.random()*a.length)],d=i.current;const c=d.indexOf(t);if(l!=i.neighbours[0]&&playAudio("/assets/audio/movement.ogg"),"office"==l){function n(){playAudio("/assets/audio/knock.ogg");const e=2*currentNight+hour;power-=e,setTimeout(()=>{power-=e,setTimeout(()=>{power-=e,setTimeout(()=>{power-=e},150)},150)},150),l=o[t]}function r(){dead=!0;const e=document.getElementById("jumpscare");switch(e.classList.remove("no"),console.log("dead",t.toString()),t){case 0:e.src="/assets/jumpscares/0.gif",playAudio("/assets/audio/bgm.mp3"),death();break;case 1:e.src="/assets/jumpscares/1.gif",setTimeout(()=>{playAudio("/assets/audio/jumpscare/3.mp3"),death()},3e3);break;case 2:e.src="/assets/jumpscares/2.png",playAudio("/assets/audio/jumpscare/2.ogg"),setTimeout(()=>{death()},1e4);break;case 3:e.src="/assets/jumpscares/3.gif",playAudio("/assets/audio/jumpscare/3.mp3"),death()}}if(0==nightData.rooms.office.current.length)switch(i.neighbours[0]){case"lhall":doors.l?n():r();break;case"rhall":doors.r?n():r()}}d.splice(c,1),nightData.rooms[l].current.push(t)}t+=1}),switchCamera(currentCamera);const s=document.getElementById("nightdatadbug");s.innerHTML="",Object.entries(nightData.rooms).forEach(e=>{s.innerHTML+="<br>"+JSON.stringify(e[0])+JSON.stringify(e[1])});document.getElementById("ticktimedbug").innerHTML=(4500-200*hour)/(quickBots?10:1),checkForAmbient(),setTimeout(()=>{mvTick()},(4500-200*hour)/(quickBots?10:1))}const instantMvTick=!1;function lighttick(){if(won)return;const e=document.getElementById("ldoor").querySelector("img"),o=document.getElementById("rdoor").querySelector("img"),t="/assets/door/closed.png",s="/assets/door/open.png";if(lights.l){var a=doors.l?t:"/assets/door/light.png";0!=nightData.rooms.lhall.current.length&&(a=`/assets/door/${nightData.rooms.lhall.current[0]}${doors.l?1:0}.png`),e.src=a}else e.src=doors.l?t:s;if(lights.r){a=doors.r?t:"/assets/door/light.png";0!=nightData.rooms.rhall.current.length&&(a=`/assets/door/${nightData.rooms.rhall.current[0]}${doors.r?1:0}.png`),o.src=a}else o.src=doors.r?t:s;setTimeout(()=>{lighttick()},200)}function death(){won||(iscameraon?setTimeout(()=>{document.getElementsByClassName("static")[0].classList.add("hide"),document.getElementsByClassName("camui")[0].style.display="none",document.getElementsByClassName("cam")[0].style.opacity=0,document.getElementsByClassName("cam")[0].style.zIndex=-2,usage-=1,document.getElementsByClassName("deathcounter")[0].classList.remove("notyet"),setTimeout(()=>{window.location.href="/menu"},1e4)},3e3):(document.getElementsByClassName("deathcounter")[0].classList.remove("notyet"),setTimeout(()=>{window.location.href="/menu"},1e4)))}setTimeout(()=>{mvTick()},1e4),setTimeout(()=>{lighttick()},500);var power=1005,usage=1,quickBots=!1,currentpowercountdown=0;function powerHandler(){if(!won){10==currentpowercountdown?(currentpowercountdown=0,power-=usage):currentpowercountdown+=1;var e=1;e+=Object.values(doors).filter(e=>e).length,e+=Object.values(lights).filter(e=>e).length,e+=iscameraon?1:0,0!=Object.values(doors).filter(e=>e).length||0!=Object.values(lights).filter(e=>e).length||iscameraon||e<usage&&(doubleDoorUsage=!1,console.log("assuming double door usage"),usage=e),power<0&&(document.getElementsByClassName("camui")[0].style.display="none",document.getElementById("cambar").remove(),document.getElementsByClassName("doors")[0].style.display="none",document.getElementsByClassName("bg")[0].style.filter="brightness(.5)",doors={l:!1,r:!1},lights={l:!1,r:!1},quickBots=!0,nightData.ai=[20,20,20,20]),document.getElementById("powerdbug").innerHTML=power,document.getElementById("usagedbug").innerHTML=usage,document.getElementById("powerui").innerHTML=Math.round(power/10);var o=`<img src="/assets/power/${usage}.png" class="usagebar">`;document.getElementById("usageui").innerHTML!=o&&(document.getElementById("usageui").innerHTML=o),setTimeout(()=>{powerHandler()},100)}}powerHandler();var hour=-1;function incrementhour(){hour+=1,document.getElementById("hour").innerHTML=(0==hour?12:hour)+" AM",6==hour&&(new Audio("/assets/audio/end.ogg").play(),won=!0,document.cookie=`save=${parseInt(getCookie("save"))+1};path=/`,document.getElementsByClassName("end")[0].classList.remove("no"),setTimeout(()=>{window.location.href="/menu"},9e3)),setTimeout(()=>{incrementhour()},6e4)}incrementhour();var withTesticularTorsion=!1,wezMiKurwaWylaczTenJebanyKrzykBoJaKurwaSieBoje=!0;const jadroAudio=addAudio("/assets/audio/stalker.mp3");function skretJadra(){withTesticularTorsion=!0,document.getElementsByClassName("testicle")[0].classList.remove("no"),mobilecheck&&document.getElementsByClassName("testiclemobile")[0].classList.remove("no"),wezMiKurwaWylaczTenJebanyKrzykBoJaKurwaSieBoje||function e(){if(!withTesticularTorsion)return stopAudioSrc("/assets/audio/stalker.mp3"),void(power-=7);playAudioId(jadroAudio),setTimeout(()=>{e()},2e3)}();var e=document.getElementsByClassName("inner")[0].style,o=0;function t(o){e.left=`${o}px`,console.log(o),Math.abs(o)<6&&setTimeout(()=>{console.log(o),Math.abs(o)<6&&(document.getElementsByClassName("testicle")[0].classList.add("no"),withTesticularTorsion=!1,mobilecheck&&document.getElementsByClassName("testiclemobile")[0].classList.add("no"))},1e3)}t(),document.getElementById("testicle-mv-left").addEventListener("click",()=>{o-=5,t(o=Math.round(o))}),document.getElementById("testicle-mv-right").addEventListener("click",()=>{o+=5,t(o=Math.round(o))}),document.addEventListener("keydown",e=>{"a"==e.key&&(o-=5),"d"==e.key&&(o+=5),o=Math.round(o),console.log(o),t(o)}),setTimeout(()=>{!function e(){t(o=100*(Math.random()-(.5-o/100))),setTimeout(()=>{e()},2e3)}()},0)}var width,limits,rotation;function defineCameraRotations(){width=document.getElementsByClassName("gra")[0].offsetWidth,rotation=((limits={l:7,r:-width/1.12+2}).l+limits.r)/2}window.addEventListener("resize",()=>{defineCameraRotations()}),defineCameraRotations();var iscameraon=!1,currentCamera=2,movingdir=0;function cammove(){if(!won)if(1!=iscameraon){var e=.0125*document.getElementsByClassName("gra")[0].offsetWidth;switch(withTesticularTorsion&&(e/=2),movingdir){case 1:rotation+e>=limits.l||(rotation+=e);break;case 2:rotation-e<limits.r||(rotation-=e)}document.getElementsByClassName("room")[0].style.left=`${rotation}px`,document.getElementById("camrotationdbug").innerHTML=rotation,setTimeout(()=>{cammove()},0)}else setTimeout(()=>{cammove()},0)}cammove();const idsWithPassthrough=["rightmov","leftmov"];idsWithPassthrough.forEach(e=>{const o=document.getElementById(e);o.addEventListener("click",e=>{console.log("passing click"),e.stopImmediatePropagation(),e.preventDefault(),o.parentNode.style.display="none";const t=document.elementFromPoint(e.clientX,e.clientY);console.log(t),o.parentNode.style.display="",t&&t.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0,clientX:e.clientX,clientY:e.clientY}))})}),document.getElementById("leftmov").addEventListener("mouseenter",function(){movingdir=1}),document.getElementById("leftmov").addEventListener("mouseleave",function(){movingdir=0}),document.getElementById("rightmov").addEventListener("mouseenter",function(){movingdir=2}),document.getElementById("rightmov").addEventListener("mouseleave",function(){movingdir=0});let params=new URLSearchParams(document.location.search);const firstgame=null==params.get("f");console.log("firstgame? ",firstgame),firstgame?(setTimeout(()=>{document.getElementsByClassName("static")[0].classList.add("hide")},500),setTimeout(()=>{document.getElementsByClassName("flash")[0].classList.remove("off"),document.getElementsByClassName("nightintro")[0].classList.remove("hide"),setTimeout(()=>{document.getElementsByClassName("flash")[0].classList.add("off")},50)},2e3)):(document.getElementsByClassName("static")[0].classList.add("hide"),document.getElementsByClassName("static")[0].style.display="none",setTimeout(()=>{document.getElementsByClassName("static")[0].style.display="block"},1e3),document.getElementById("newspaper").remove(),document.getElementsByClassName("flash")[0].classList.remove("off"),document.getElementsByClassName("nightintro")[0].classList.remove("hide"),setTimeout(()=>{document.getElementsByClassName("flash")[0].classList.add("off")},50));var skipIntro=!1;function formattedNum(e){return 0==e?"???":1==e?e+"st":2==e?e+"nd":3==e?e+"rd":e+"th"}skipIntro&&(document.getElementById("realgra").style.display=""),setTimeout(()=>{document.getElementsByClassName("flash")[0].classList.remove("off"),document.getElementById("realgra").style.display="",setTimeout(()=>{document.getElementsByClassName("flash")[0].classList.add("off")},100)},6e3),setTimeout(()=>{!function e(){won||(67!=Math.round(100*Math.random())||withTesticularTorsion||skretJadra(),setTimeout(()=>{e()},1500))}()},15e3),document.getElementById("intronightnum").innerHTML=formattedNum(currentNight),document.getElementById("curnightui").innerHTML=currentNight;const doorOpenL=new Audio("/assets/audio/door-open-l.ogg"),doorOpenR=new Audio("/assets/audio/door-open-r.ogg"),doorCloseL=new Audio("/assets/audio/door-close-l.ogg"),doorCloseR=new Audio("/assets/audio/door-close-r.ogg");var lastDoorLClose=0,lastDoorRClose=0,lastDoorLOpen=0,lastDoorROpen=0,doubleDoorUsage=!1;function door(e){if(won)return;const o=document.getElementById("ldoor").querySelector("img"),t=document.getElementById("rdoor").querySelector("img"),s="/assets/door/closed.png",a="/assets/door/open.png";switch(e){case 0:doors.l=!doors.l,o.src=doors.l?s:a,doors.l?(lastDoorLClose=Date.now(),doorCloseL.play(),doorOpenL.pause(),doorOpenL.currentTime=0):(lastDoorLOpen=Date.now(),doorOpenL.play(),doorCloseL.pause(),doorCloseL.currentTime=0),doors.l?usage+=1:usage-=1;break;case 1:doors.r=!doors.r,t.src=doors.r?s:a,doors.r?(lastDoorRClose=Date.now(),doorCloseR.play(),doorOpenR.pause(),doorOpenR.currentTime=0):(lastDoorROpen=Date.now(),doorOpenR.play(),doorCloseR.pause(),doorCloseR.currentTime=0),doors.r?usage+=1:usage-=1}document.getElementById("doorsdbug").innerText=`${doors.l}  ${doors.r}`}function checkDoor(){(doors.l&&lastDoorLClose+1e3*(30*Math.random()+9)<Date.now()||doors.r&&lastDoorRClose+1e3*(30*Math.random()+9)<Date.now())&&!doubleDoorUsage&&(doubleDoorUsage=!0,usage+=Object.values(doors).filter(e=>e).length),setTimeout(()=>{checkDoor()},1e3)}checkDoor();const lightAudioL=new Audio("/assets/audio/light-l.ogg"),lightAudioR=new Audio("/assets/audio/light-r.ogg");function light(e){if(won)return;const o=document.getElementById("ldoor").querySelector("img"),t=document.getElementById("rdoor").querySelector("img");switch(e){case 0:if(lights.l=!lights.l,lights.l?o.classList.add("light"):o.classList.remove("light"),lights.l){lights.r&&(lights.r=!1,usage-=1);var s=doors.l?"/assets/door/closed.png":"/assets/door/light.png";lightAudioL.play(),0!=nightData.rooms.lhall.current.length&&(s=`/assets/door/${nightData.rooms.lhall.current[0]}${doors.l?1:0}.png`),o.src=s}else o.src=`/assets/door/${doors.l?"closed":"open"}.png`,lightAudioL.pause();lights.l?usage+=1:usage-=1;break;case 1:if(lights.r=!lights.r,lights.r?t.classList.add("light"):t.classList.remove("light"),lights.r){lights.l&&(lights.l=!1,usage-=1);s=doors.r?"/assets/door/closed.png":"/assets/door/light.png";lightAudioR.play(),0!=nightData.rooms.rhall.current.length&&(s=`/assets/door/${nightData.rooms.rhall.current[0]}${doors.r?1:0}.png`),t.src=s}else t.src=`/assets/door/${doors.r?"closed":"open"}.png`,lightAudioR.pause();lights.r?usage+=1:usage-=1}document.getElementById("lightdbug").innerText=`${lights.l}  ${lights.r}`}function checklight(e){if(won)return;const o=document.getElementById("ldoor").querySelector("img"),t=document.getElementById("rdoor").querySelector("img");switch(e){case 0:lights.l&&(usage-=1),lights.l=!1,o.classList.remove("light"),lightAudioL.pause(),doors.l?o.src="/assets/door/closed.png":o.src="/assets/door/open.png";break;case 1:lights.r&&(usage-=1),lights.r=!1,t.classList.remove("light"),lightAudioR.pause(),doors.r?t.src="/assets/door/closed.png":t.src="/assets/door/open.png"}document.getElementById("lightdbug").innerText=`${lights.l}  ${lights.r}`}lightAudioL.loop=!0,lightAudioR.loop=!0;const cameraNames={0:"Right Hall",1:"Stage",2:"Party Room 2",3:"Pirate Cove",4:"Party Room 1",5:"Entrance",6:"Saferoom",7:"Main Hall",8:"Left Hall",9:"Dining",10:"Dining"};function switchCamera(e){if(!won){currentCamera=e,e-=1,document.getElementById("gamemapcurrentcameraname").innerText=cameraNames[e].toUpperCase();var o=Object.entries(nightData.rooms).filter(e=>e[1].hasCamera).at(e),t=o[1].current,s=0;t.forEach(e=>{s+=Math.pow(2,e)}),console.log(o[0],"sum",s),document.getElementsByClassName("cam")[0].src.endsWith(`/assets/rooms/${e}-${s}.webp`)||(iscameraon&&new Audio("/assets/audio/camera-switch.ogg").play(),document.getElementsByClassName("static")[0].classList.add("high"),document.getElementsByClassName("cam")[0].src=`/assets/rooms/${e}-${s}.webp`),setTimeout(()=>{document.getElementsByClassName("static")[0].classList.remove("high")},100)}}const bar=document.getElementById("cambar");var lastCameraOpen=0,lastCameraClose=0,foxyStun=1e3*(17*Math.random()+.8);bar.addEventListener("mouseenter",function(){won||(document.getElementsByClassName("static")[0].classList.add("notrans"),iscameraon=!iscameraon,console.log("camera",iscameraon),iscameraon?(changeVolume(.1),lastCameraOpen=Date.now(),foxyStun=1e3*(17*Math.random()+.8),document.getElementsByClassName("cameracontrols")[0].style.display="none",document.getElementsByClassName("room")[0].style.display="none",document.getElementsByClassName("static")[0].querySelector("audio").play(),document.getElementsByClassName("static")[0].classList.remove("hide"),document.getElementsByClassName("camui")[0].style.display="inherit",document.getElementsByClassName("cam")[0].style.opacity=1,document.getElementsByClassName("cam")[0].style.zIndex=3,usage+=1):(changeVolume(1),lastCameraClose=Date.now(),foxyStun=1e3*(17*Math.random()+.8),document.getElementsByClassName("cameracontrols")[0].style.display="flex",document.getElementsByClassName("room")[0].style.display="inherit",document.getElementsByClassName("static")[0].querySelector("audio").pause(),document.getElementsByClassName("static")[0].classList.add("hide"),document.getElementsByClassName("camui")[0].style.display="none",document.getElementsByClassName("cam")[0].style.opacity=0,document.getElementsByClassName("cam")[0].style.zIndex=-2,usage-=1),bar.style.opacity=0,document.getElementById("arecamsondbug").innerText=iscameraon?"yes":"no")}),bar.addEventListener("mouseleave",function(){won||setTimeout(()=>{bar.style.opacity=1},250)});